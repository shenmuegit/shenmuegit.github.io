---
layout: default
title: å¾®æœåŠ¡æ¡†æ¶æ¶Œç°
parent: JDK 8 æ—¶ä»£
grand_parent: JavaæŠ€æœ¯ç”Ÿæ€æ¼”è¿›
nav_order: 3
---

# å¾®æœåŠ¡æ¡†æ¶æ¶Œç°

<p align="center">
  <img src="https://img.shields.io/badge/éš¾åº¦-é«˜çº§-red" alt="éš¾åº¦">
  <img src="https://img.shields.io/badge/é˜…è¯»æ—¶é•¿-50åˆ†é’Ÿ-blue" alt="æ—¶é•¿">
  <img src="https://img.shields.io/badge/JDK-1.8-red" alt="JDK">
</p>

---

## ğŸ“ æ—¶é—´çº¿å®šä½

```mermaid
timeline
    title Java å¾®æœåŠ¡æ¡†æ¶æ¼”è¿›
    section å•ä½“æ—¶ä»£
        2000-2010 : å•ä½“æ¶æ„
                  : SSH/SSM
    section å¾®æœåŠ¡èŒèŠ½
        2011 : Dubbo å¼€æº
        2014 : ğŸ“ å¾®æœåŠ¡æ¦‚å¿µæµè¡Œ
             : Spring Boot å‘å¸ƒ
    section å¾®æœåŠ¡çˆ†å‘
        2015 : Spring Cloud Netflix
        2018 : Spring Cloud Alibaba
        2020+ : Service Mesh
```

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- âœ… ç†è§£å•ä½“æ¶æ„çš„ç“¶é¢ˆä¸å¾®æœåŠ¡çš„å…´èµ·
- âœ… äº†è§£ Dubbo çš„è®¾è®¡ç†å¿µä¸æ ¸å¿ƒç»„ä»¶
- âœ… æŒæ¡ Spring Cloud çš„æœåŠ¡æ²»ç†å…¨å®¶æ¡¶
- âœ… å¯¹æ¯” Dubbo ä¸ Spring Cloud çš„é€‰å‹ç­–ç•¥

---

## ğŸ“– ç« èŠ‚æ‘˜è¦

éšç€äº’è”ç½‘ä¸šåŠ¡è§„æ¨¡çš„å¢é•¿ï¼Œå•ä½“æ¶æ„çš„å±€é™æ€§æ—¥ç›Šæ˜æ˜¾ã€‚Dubbo å’Œ Spring Cloud ä»£è¡¨äº†ä¸¤ç§å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆçš„æ€è·¯ï¼šRPC æ¡†æ¶ vs æœåŠ¡æ²»ç†å…¨å®¶æ¡¶ã€‚

---

## 1. å†å²èƒŒæ™¯ä¸ç—›ç‚¹

### 1.1 å•ä½“æ¶æ„çš„ç“¶é¢ˆ

```mermaid
graph TB
    subgraph å•ä½“åº”ç”¨
        A[ç”¨æˆ·æ¨¡å—] --> DB[(æ•°æ®åº“)]
        B[è®¢å•æ¨¡å—] --> DB
        C[å•†å“æ¨¡å—] --> DB
        D[æ”¯ä»˜æ¨¡å—] --> DB
    end
    
    E[æ‰€æœ‰ä»£ç åœ¨ä¸€èµ·] --> F[éƒ¨ç½²è€¦åˆ]
    F --> G[æ‰©å±•å›°éš¾]
    G --> H[æŠ€æœ¯æ ˆé”å®š]
```

**å•ä½“æ¶æ„çš„é—®é¢˜**ï¼š

| é—®é¢˜ | å½±å“ |
|------|------|
| ä»£ç è€¦åˆ | ä¿®æ”¹ä¸€å¤„å½±å“å…¨å±€ |
| éƒ¨ç½²è€¦åˆ | å°æ”¹åŠ¨éœ€è¦å…¨é‡éƒ¨ç½² |
| æ‰©å±•å›°éš¾ | åªèƒ½æ•´ä½“æ‰©å±•ï¼Œæ— æ³•æŒ‰éœ€æ‰©å±• |
| æŠ€æœ¯æ ˆé”å®š | æ‰€æœ‰æ¨¡å—å¿…é¡»ä½¿ç”¨ç›¸åŒæŠ€æœ¯ |
| å›¢é˜Ÿåä½œéš¾ | å¤šå›¢é˜Ÿåœ¨åŒä¸€ä»£ç åº“å†²çª |

### 1.2 å¾®æœåŠ¡ç†å¿µ

> ğŸ‘¤ **å…³é”®äººç‰©**ï¼šMartin Fowler åœ¨ 2014 å¹´å‘è¡¨çš„æ–‡ç« ã€ŠMicroservicesã€‹æ­£å¼å®šä¹‰äº†å¾®æœåŠ¡æ¶æ„ã€‚

```mermaid
graph TB
    subgraph å¾®æœåŠ¡æ¶æ„
        U[ç”¨æˆ·æœåŠ¡] --> UDB[(ç”¨æˆ·åº“)]
        O[è®¢å•æœåŠ¡] --> ODB[(è®¢å•åº“)]
        P[å•†å“æœåŠ¡] --> PDB[(å•†å“åº“)]
        
        U <-->|API| O
        O <-->|API| P
    end
    
    A[ç‹¬ç«‹å¼€å‘] --> B[ç‹¬ç«‹éƒ¨ç½²]
    B --> C[ç‹¬ç«‹æ‰©å±•]
    C --> D[æŠ€æœ¯å¼‚æ„]
```

---

## 2. Dubboï¼šå›½äº§ RPC æ¡†æ¶

### 2.1 Dubbo ç®€ä»‹

Dubbo æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„é«˜æ€§èƒ½ RPC æ¡†æ¶ï¼š

```mermaid
graph TB
    subgraph Dubbo æ¶æ„
        C[Consumer] -->|è°ƒç”¨| P[Provider]
        C -->|è®¢é˜…| R[Registry]
        P -->|æ³¨å†Œ| R
        C -->|ç›‘æ§| M[Monitor]
        P -->|ç›‘æ§| M
    end
```

### 2.2 æ ¸å¿ƒç‰¹æ€§

```java
// Provider: æœåŠ¡æä¾›è€…
@DubboService(version = "1.0.0")
public class UserServiceImpl implements UserService {
    
    @Override
    public User findById(Long id) {
        return userDao.findById(id);
    }
}

// Consumer: æœåŠ¡æ¶ˆè´¹è€…
@Component
public class OrderService {
    
    @DubboReference(version = "1.0.0")
    private UserService userService;  // åƒæœ¬åœ°è°ƒç”¨ä¸€æ ·
    
    public void createOrder(Long userId) {
        User user = userService.findById(userId);  // è¿œç¨‹è°ƒç”¨
        // ...
    }
}
```

### 2.3 Dubbo æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | ä½œç”¨ |
|------|------|
| Provider | æœåŠ¡æä¾›è€… |
| Consumer | æœåŠ¡æ¶ˆè´¹è€… |
| Registry | æ³¨å†Œä¸­å¿ƒï¼ˆZooKeeper/Nacosï¼‰ |
| Monitor | ç›‘æ§ä¸­å¿ƒ |
| Container | æœåŠ¡å®¹å™¨ |

### 2.4 Dubbo çš„ä¼˜åŠ¿

- **é«˜æ€§èƒ½**ï¼šè‡ªå®šä¹‰ Dubbo åè®®ï¼Œæ¯” HTTP æ›´å¿«
- **æœåŠ¡æ²»ç†**ï¼šè´Ÿè½½å‡è¡¡ã€ç†”æ–­ã€é™æµ
- **æ‰©å±•æ€§å¼º**ï¼šSPI æœºåˆ¶ï¼Œå¯æ‰©å±•åè®®ã€åºåˆ—åŒ–ç­‰

---

## 3. Spring Cloudï¼šæœåŠ¡æ²»ç†å…¨å®¶æ¡¶

### 3.1 Spring Cloud Netflix

2015 å¹´ï¼ŒSpring Cloud Netflix å¸¦æ¥äº†å®Œæ•´çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼š

```mermaid
graph TB
    subgraph Spring Cloud Netflix
        A[Eureka] -->|æœåŠ¡å‘ç°| B[æœåŠ¡æ³¨å†Œä¸­å¿ƒ]
        C[Ribbon] -->|è´Ÿè½½å‡è¡¡| D[å®¢æˆ·ç«¯è´Ÿè½½]
        E[Feign] -->|å£°æ˜å¼è°ƒç”¨| F[HTTP å®¢æˆ·ç«¯]
        G[Hystrix] -->|ç†”æ–­å™¨| H[æœåŠ¡ä¿æŠ¤]
        I[Zuul] -->|ç½‘å…³| J[API ç½‘å…³]
        K[Config] -->|é…ç½®ä¸­å¿ƒ| L[é›†ä¸­é…ç½®]
    end
```

### 3.2 æ ¸å¿ƒç»„ä»¶

#### 3.2.1 Eureka æœåŠ¡æ³¨å†Œ

```java
// Eureka Server
@SpringBootApplication
@EnableEurekaServer
public class EurekaServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(EurekaServerApplication.class, args);
    }
}

// Eureka Client
@SpringBootApplication
@EnableEurekaClient
public class UserServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(UserServiceApplication.class, args);
    }
}
```

```yaml
# Eureka Client é…ç½®
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
  instance:
    prefer-ip-address: true
```

#### 3.2.2 Feign å£°æ˜å¼è°ƒç”¨

```java
// å®šä¹‰ Feign Client
@FeignClient(name = "user-service")
public interface UserClient {
    
    @GetMapping("/users/{id}")
    User findById(@PathVariable Long id);
    
    @PostMapping("/users")
    User create(@RequestBody User user);
}

// ä½¿ç”¨
@Service
public class OrderService {
    
    @Autowired
    private UserClient userClient;
    
    public void createOrder(Long userId) {
        User user = userClient.findById(userId);  // HTTP è°ƒç”¨
        // ...
    }
}
```

#### 3.2.3 Hystrix ç†”æ–­å™¨

```java
@FeignClient(name = "user-service", fallback = UserClientFallback.class)
public interface UserClient {
    @GetMapping("/users/{id}")
    User findById(@PathVariable Long id);
}

// é™çº§å®ç°
@Component
public class UserClientFallback implements UserClient {
    @Override
    public User findById(Long id) {
        return new User(-1L, "Default User");  // é™çº§è¿”å›
    }
}
```

### 3.3 Spring Cloud Alibaba

2018 å¹´ï¼ŒSpring Cloud Alibaba æä¾›äº†æ›´é€‚åˆå›½å†…åœºæ™¯çš„ç»„ä»¶ï¼š

| Netflix ç»„ä»¶ | Alibaba æ›¿ä»£ | è¯´æ˜ |
|-------------|-------------|------|
| Eureka | Nacos | æœåŠ¡å‘ç° + é…ç½®ä¸­å¿ƒ |
| Hystrix | Sentinel | ç†”æ–­ + é™æµ |
| Zuul | Gateway | API ç½‘å…³ |
| Config | Nacos Config | é…ç½®ä¸­å¿ƒ |

---

## 4. Dubbo vs Spring Cloud

### 4.1 å¯¹æ¯”åˆ†æ

| ç»´åº¦ | Dubbo | Spring Cloud |
|------|-------|--------------|
| å®šä½ | RPC æ¡†æ¶ | å¾®æœåŠ¡å…¨å®¶æ¡¶ |
| åè®® | Dubbo åè®®ï¼ˆé«˜æ€§èƒ½ï¼‰ | HTTP/RESTï¼ˆé€šç”¨æ€§ï¼‰ |
| æ³¨å†Œä¸­å¿ƒ | ZooKeeper/Nacos | Eureka/Nacos/Consul |
| æœåŠ¡è°ƒç”¨ | æ¥å£ä»£ç† | Feign å£°æ˜å¼ |
| ç†”æ–­é™æµ | Sentinel | Hystrix/Sentinel |
| é…ç½®ä¸­å¿ƒ | éœ€æ•´åˆ | Spring Cloud Config |
| ç½‘å…³ | éœ€æ•´åˆ | Zuul/Gateway |
| å­¦ä¹ æ›²çº¿ | è¾ƒä½ | è¾ƒé«˜ |
| ç”Ÿæ€ | é˜¿é‡Œç”Ÿæ€ | Spring ç”Ÿæ€ |

### 4.2 é€‰å‹å»ºè®®

```mermaid
flowchart TD
    A[é€‰æ‹©å¾®æœåŠ¡æ¡†æ¶] --> B{æ€§èƒ½è¦æ±‚?}
    B -->|é«˜æ€§èƒ½ RPC| C[Dubbo]
    B -->|é€šç”¨æ€§ä¼˜å…ˆ| D{å›¢é˜ŸèƒŒæ™¯?}
    D -->|ç†Ÿæ‚‰ Spring| E[Spring Cloud]
    D -->|ç†Ÿæ‚‰é˜¿é‡ŒæŠ€æœ¯| F[Dubbo + Spring Cloud Alibaba]
    
    G{æ˜¯å¦éœ€è¦è·¨è¯­è¨€?}
    G -->|æ˜¯| H[gRPC / HTTP]
    G -->|å¦| C
```

---

## 5. ä»£ç æ¼”è¿›ç¤ºä¾‹

### 5.1 ä»å•ä½“åˆ°å¾®æœåŠ¡

```java
// ========== å•ä½“æ¶æ„ ==========
@Service
public class OrderService {
    @Autowired
    private UserDao userDao;  // ç›´æ¥è®¿é—®åŒåº“
    
    @Autowired
    private ProductDao productDao;
    
    public void createOrder(OrderDTO dto) {
        User user = userDao.findById(dto.getUserId());
        Product product = productDao.findById(dto.getProductId());
        // åˆ›å»ºè®¢å•...
    }
}

// ========== å¾®æœåŠ¡æ¶æ„ ==========
@Service
public class OrderService {
    @Autowired
    private UserClient userClient;  // è¿œç¨‹è°ƒç”¨
    
    @Autowired
    private ProductClient productClient;
    
    public void createOrder(OrderDTO dto) {
        User user = userClient.findById(dto.getUserId());
        Product product = productClient.findById(dto.getProductId());
        // åˆ›å»ºè®¢å•...
    }
}
```

### 5.2 æœåŠ¡æ²»ç†æ¼”è¿›

```java
// ========== V1: ç¡¬ç¼–ç è°ƒç”¨ ==========
String url = "http://192.168.1.100:8080/users/" + userId;
User user = restTemplate.getForObject(url, User.class);

// ========== V2: æœåŠ¡å‘ç° ==========
@Autowired
private DiscoveryClient discoveryClient;

List<ServiceInstance> instances = discoveryClient.getInstances("user-service");
String url = instances.get(0).getUri() + "/users/" + userId;

// ========== V3: è´Ÿè½½å‡è¡¡ ==========
@LoadBalanced
@Bean
public RestTemplate restTemplate() {
    return new RestTemplate();
}

// ä½¿ç”¨æœåŠ¡åè°ƒç”¨
User user = restTemplate.getForObject(
    "http://user-service/users/" + userId, User.class);

// ========== V4: å£°æ˜å¼è°ƒç”¨ ==========
@FeignClient("user-service")
public interface UserClient {
    @GetMapping("/users/{id}")
    User findById(@PathVariable Long id);
}

User user = userClient.findById(userId);  // æœ€ç®€æ´
```

---

## 6. æŠ€æœ¯å…³è”åˆ†æ

### 6.1 å¾®æœåŠ¡ä¸ JDK/æ¡†æ¶

```mermaid
graph TB
    subgraph JDK 8
        A[Lambda] --> B[ç®€åŒ–å›è°ƒ]
        C[CompletableFuture] --> D[å¼‚æ­¥ç¼–æ’]
    end
    
    subgraph Spring Boot
        E[è‡ªåŠ¨é…ç½®] --> F[å¿«é€Ÿå¯åŠ¨æœåŠ¡]
        G[åµŒå…¥å¼å®¹å™¨] --> H[ç‹¬ç«‹éƒ¨ç½²]
    end
    
    subgraph å¾®æœåŠ¡
        B --> I[Feign å›è°ƒ]
        D --> J[æœåŠ¡ç¼–æ’]
        F --> K[æ¯ä¸ªæœåŠ¡ç‹¬ç«‹]
        H --> L[å®¹å™¨åŒ–éƒ¨ç½²]
    end
```

### 6.2 å¾®æœåŠ¡æŠ€æœ¯æ ˆå…¨æ™¯

```mermaid
graph TB
    subgraph æœåŠ¡æ²»ç†
        A[æœåŠ¡æ³¨å†Œå‘ç°]
        B[é…ç½®ä¸­å¿ƒ]
        C[æœåŠ¡ç½‘å…³]
        D[è´Ÿè½½å‡è¡¡]
    end
    
    subgraph æœåŠ¡ä¿æŠ¤
        E[ç†”æ–­å™¨]
        F[é™æµ]
        G[é™çº§]
    end
    
    subgraph å¯è§‚æµ‹æ€§
        H[é“¾è·¯è¿½è¸ª]
        I[æ—¥å¿—èšåˆ]
        J[æŒ‡æ ‡ç›‘æ§]
    end
    
    subgraph éƒ¨ç½²
        K[Docker]
        L[Kubernetes]
    end
```

---

## 7. æ¼”è¿›è§„å¾‹æ€»ç»“

### 7.1 ä»ç´§è€¦åˆåˆ°æ¾è€¦åˆ

```
å•ä½“æ¶æ„ï¼ˆç´§è€¦åˆï¼‰â†’ å¾®æœåŠ¡ï¼ˆæ¾è€¦åˆï¼‰

æœåŠ¡è¾¹ç•Œæ¸…æ™°ï¼Œå›¢é˜Ÿå¯ä»¥ç‹¬ç«‹å¼€å‘éƒ¨ç½²ã€‚
```

### 7.2 ä»åŒæ­¥åˆ°å¼‚æ­¥

```
åŒæ­¥ HTTP è°ƒç”¨ â†’ æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥è§£è€¦

æé«˜ç³»ç»Ÿååé‡å’Œå¯é æ€§ã€‚
```

### 7.3 ä»æ‰‹åŠ¨åˆ°è‡ªåŠ¨

```
æ‰‹åŠ¨è¿ç»´ â†’ æœåŠ¡æ²»ç†å¹³å°

æ³¨å†Œå‘ç°ã€è´Ÿè½½å‡è¡¡ã€ç†”æ–­é™æµè‡ªåŠ¨åŒ–ã€‚
```

---

## 8. ç‰¹æ®Šå…ƒç´ 

### ğŸ‘¤ å…³é”®äººç‰©

| äººç‰©/å›¢é˜Ÿ | è´¡çŒ® |
|----------|------|
| Martin Fowler | å¾®æœåŠ¡æ¦‚å¿µå®šä¹‰ |
| Netflix OSS å›¢é˜Ÿ | Eurekaã€Hystrixã€Zuul |
| é˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿ | Dubboã€Nacosã€Sentinel |

### ğŸ’¼ é¢è¯•è€ƒç‚¹

**Q1: å¾®æœåŠ¡çš„ä¼˜ç¼ºç‚¹ï¼Ÿ**

ä¼˜ç‚¹ï¼š
- ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²ã€æ‰©å±•
- æŠ€æœ¯æ ˆçµæ´»
- æ•…éšœéš”ç¦»

ç¼ºç‚¹ï¼š
- åˆ†å¸ƒå¼å¤æ‚æ€§
- ç½‘ç»œå»¶è¿Ÿ
- æ•°æ®ä¸€è‡´æ€§æŒ‘æˆ˜
- è¿ç»´æˆæœ¬é«˜

**Q2: CAP ç†è®ºä¸æœåŠ¡å‘ç°ï¼Ÿ**

ç­”ï¼š
- Eurekaï¼šAPï¼ˆå¯ç”¨æ€§ + åˆ†åŒºå®¹é”™ï¼‰ï¼Œå¼±ä¸€è‡´æ€§
- ZooKeeperï¼šCPï¼ˆä¸€è‡´æ€§ + åˆ†åŒºå®¹é”™ï¼‰ï¼Œå¯èƒ½ä¸å¯ç”¨
- Nacosï¼šæ”¯æŒ AP å’Œ CP æ¨¡å¼åˆ‡æ¢

**Q3: ç†”æ–­å™¨çš„å·¥ä½œåŸç†ï¼Ÿ**

ç­”ï¼ˆä»¥ Hystrix ä¸ºä¾‹ï¼‰ï¼š
1. **Closed**ï¼ˆå…³é—­ï¼‰ï¼šæ­£å¸¸è°ƒç”¨
2. **Open**ï¼ˆæ‰“å¼€ï¼‰ï¼šå¤±è´¥ç‡è¶…é˜ˆå€¼ï¼Œå¿«é€Ÿå¤±è´¥
3. **Half-Open**ï¼ˆåŠå¼€ï¼‰ï¼šå°è¯•æ¢å¤ï¼ŒæˆåŠŸåˆ™å…³é—­ï¼Œå¤±è´¥åˆ™ç»§ç»­æ‰“å¼€

```mermaid
stateDiagram-v2
    [*] --> Closed
    Closed --> Open: å¤±è´¥ç‡è¶…é˜ˆå€¼
    Open --> HalfOpen: è¶…æ—¶å
    HalfOpen --> Closed: æ¢æµ‹æˆåŠŸ
    HalfOpen --> Open: æ¢æµ‹å¤±è´¥
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [Microservices - Martin Fowler](https://martinfowler.com/articles/microservices.html)
- [Dubbo å®˜æ–¹æ–‡æ¡£](https://dubbo.apache.org/)
- [Spring Cloud å®˜æ–¹æ–‡æ¡£](https://spring.io/projects/spring-cloud)
- [Spring Cloud Alibaba](https://github.com/alibaba/spring-cloud-alibaba)

---

<p align="center">
  â¬…ï¸ <a href="./02-SpringBootç ´èŒ§è€Œå‡º.md">ä¸Šä¸€ç¯‡ï¼šSpring Bootç ´èŒ§è€Œå‡º</a> |
  ğŸ  <a href="../../README.md">è¿”å›ç›®å½•</a> |
  <a href="../05-JDK9-11æ—¶ä»£/01-æ¨¡å—åŒ–ä¸æ–°API.md">ä¸‹ä¸€ç¯‡ï¼šæ¨¡å—åŒ–ä¸æ–°API</a> â¡ï¸
</p>

