---
layout: default
title: æ¶æ„è®¾è®¡ä¸ OpenObserve éƒ¨ç½²
parent: OpenObserve éƒ¨ç½²
grand_parent: å¯è§‚æµ‹æ€§å®æˆ˜
nav_order: 1
---

# æ¶æ„è®¾è®¡ä¸ OpenObserve éƒ¨ç½²

> ğŸ“Š **éš¾åº¦**ï¼šğŸŸ¡ è¿›é˜¶ | â±ï¸ **é˜…è¯»æ—¶é—´**ï¼š25 åˆ†é’Ÿ
>
> ğŸ“ **æœ¬ç« æ‘˜è¦**ï¼šä»‹ç» OpenObserve + Vector çš„æ•´ä½“æ¶æ„è®¾è®¡ï¼Œå¹¶é€šè¿‡ Helm åœ¨ Kubernetes ä¸Šéƒ¨ç½² OpenObserve Standalone æ¨¡å¼ã€‚

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

å­¦å®Œæœ¬ç« åï¼Œä½ å°†èƒ½å¤Ÿï¼š

- ç†è§£ OpenObserve + Vector çš„æ—¥å¿—é‡‡é›†æ¶æ„
- äº†è§£ OpenObserve çš„æ ¸å¿ƒç‰¹æ€§
- åœ¨ Kubernetes ä¸Šéƒ¨ç½² OpenObserve Standalone æ¨¡å¼
- é…ç½® OpenObserve çš„åŸºç¡€å‚æ•°

---

## ğŸ“‹ å‰ç½®è¦æ±‚

- ğŸ”§ **Kubernetes é›†ç¾¤**ï¼šå·²è¿è¡Œçš„ K8s é›†ç¾¤ï¼ˆMinikubeã€Kindã€EKSã€GKE ç­‰ï¼‰
- âˆ **Helm 3.x**ï¼šå·²å®‰è£… Helm åŒ…ç®¡ç†å™¨
- ğŸ–¥ï¸ **kubectl**ï¼šå·²é…ç½®é›†ç¾¤è®¿é—®æƒé™

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„æ¦‚è¿°

### æ¶æ„å›¾

```mermaid
graph TB
    subgraph K8s Cluster
        subgraph Node1[Node 1]
            V1[Vector<br/>DaemonSet]
            L1[/var/logs/*.log/]
        end
        
        subgraph Node2[Node 2]
            V2[Vector<br/>DaemonSet]
            L2[/var/logs/*.log/]
        end
        
        subgraph Node3[Node 3]
            V3[Vector<br/>DaemonSet]
            L3[/var/logs/*.log/]
        end
        
        subgraph OpenObserve Namespace
            O2[OpenObserve<br/>Standalone]
            API[HTTP API<br/>:5080]
        end
    end
    
    subgraph External Storage
        MINIO[(MinIO<br/>å¯¹è±¡å­˜å‚¨)]
    end
    
    L1 --> V1
    L2 --> V2
    L3 --> V3
    
    V1 -->|HTTP POST| API
    V2 -->|HTTP POST| API
    V3 -->|HTTP POST| API
    
    API --> O2
    O2 -->|å­˜å‚¨| MINIO
```

### ç»„ä»¶èŒè´£

| ç»„ä»¶ | èŒè´£ | éƒ¨ç½²æ–¹å¼ |
|------|------|---------|
| **OpenObserve** | æ—¥å¿—å­˜å‚¨ã€ç´¢å¼•ã€æŸ¥è¯¢ã€å¯è§†åŒ– | Deployment (Standalone) |
| **Vector** | æ—¥å¿—é‡‡é›†ã€è§£æã€è½¬å‘ | DaemonSet (æ¯èŠ‚ç‚¹ä¸€ä¸ª) |
| **MinIO** | å¯¹è±¡å­˜å‚¨åç«¯ | å¤–éƒ¨æœåŠ¡ï¼ˆåç»­åšå®¢è¯¦è§£ï¼‰ |

### æ•°æ®æµå‘

```mermaid
flowchart LR
    A[åº”ç”¨æ—¥å¿—] --> B[/var/logs/*.log]
    B --> C[Vector<br/>file source]
    C --> D[Vector<br/>remap transform]
    D --> E[Vector<br/>http sink]
    E -->|HTTP POST| F[OpenObserve API]
    F --> G[OpenObserve<br/>ç´¢å¼•å­˜å‚¨]
    G --> H[(MinIO)]
```

---

## ğŸ“¦ OpenObserve ç®€ä»‹

### ä»€ä¹ˆæ˜¯ OpenObserveï¼Ÿ

[OpenObserve](https://openobserve.ai/) æ˜¯ä¸€ä¸ªäº‘åŸç”Ÿçš„å¯è§‚æµ‹æ€§å¹³å°ï¼Œæ”¯æŒæ—¥å¿—ã€æŒ‡æ ‡ã€é“¾è·¯è¿½è¸ªçš„ç»Ÿä¸€å­˜å‚¨ä¸åˆ†æã€‚

### æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **é«˜æ€§èƒ½** | åŸºäº Rust å¼€å‘ï¼Œèµ„æºæ¶ˆè€—ä½ |
| **ç»Ÿä¸€å¹³å°** | Logsã€Metricsã€Traces ä¸‰åˆä¸€ |
| **ä½æˆæœ¬å­˜å‚¨** | æ”¯æŒ S3/MinIO ç­‰å¯¹è±¡å­˜å‚¨ |
| **æ˜“äºéƒ¨ç½²** | å•äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ”¯æŒ Helm |
| **å…¼å®¹æ€§** | å…¼å®¹ Elasticsearch API |

### Standalone vs HA æ¨¡å¼

| æ¨¡å¼ | é€‚ç”¨åœºæ™¯ | ç‰¹ç‚¹ |
|------|---------|------|
| **Standalone** | å¼€å‘æµ‹è¯•ã€å°è§„æ¨¡ç”Ÿäº§ | å•èŠ‚ç‚¹ï¼Œéƒ¨ç½²ç®€å• |
| **HA** | å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒ | å¤šèŠ‚ç‚¹ï¼Œé«˜å¯ç”¨ |

æœ¬æ•™ç¨‹ä½¿ç”¨ **Standalone æ¨¡å¼**ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ å’Œä¸­å°è§„æ¨¡åœºæ™¯ã€‚

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»º Namespace

```bash
kubectl create namespace openobserve
```

**âœ… æ£€æŸ¥ç‚¹ï¼š** æ‰§è¡Œ `kubectl get ns openobserve` ç¡®è®¤ Namespace å·²åˆ›å»ºã€‚

---

### æ­¥éª¤ 2ï¼šæ·»åŠ  Helm ä»“åº“

```bash
# æ·»åŠ  OpenObserve Helm ä»“åº“
helm repo add openobserve https://charts.openobserve.ai

# æ›´æ–°ä»“åº“ç´¢å¼•
helm repo update
```

**âœ… æ£€æŸ¥ç‚¹ï¼š** æ‰§è¡Œ `helm search repo openobserve` åº”æ˜¾ç¤ºå¯ç”¨çš„ chartï¼š

```
NAME                            CHART VERSION   APP VERSION
openobserve/openobserve         x.x.x           x.x.x
```

---

### æ­¥éª¤ 3ï¼šåˆ›å»º values.yaml

åˆ›å»º `openobserve-values.yaml` æ–‡ä»¶ï¼š

```yaml
# OpenObserve Standalone éƒ¨ç½²é…ç½®
# æ–‡ä»¶ï¼šopenobserve-values.yaml

# å‰¯æœ¬æ•°ï¼ˆStandalone æ¨¡å¼ä¸º 1ï¼‰
replicaCount: 1

# é•œåƒé…ç½®
image:
  repository: public.ecr.aws/zinclabs/openobserve
  pullPolicy: IfNotPresent
  # tag: "latest"  # ä½¿ç”¨ chart é»˜è®¤ç‰ˆæœ¬

# æœåŠ¡é…ç½®
service:
  type: ClusterIP
  port: 5080

# èµ„æºé™åˆ¶
resources:
  requests:
    cpu: "256m"
    memory: "512Mi"
  limits:
    cpu: "1"
    memory: "2Gi"

# è®¤è¯é…ç½®
auth:
  # åˆå§‹ç®¡ç†å‘˜è´¦æˆ·
  ZO_ROOT_USER_EMAIL: "admin@example.com"      # è¯·æ›¿æ¢ä¸ºå®é™…é‚®ç®±
  ZO_ROOT_USER_PASSWORD: "your-secure-password" # è¯·æ›¿æ¢ä¸ºå¼ºå¯†ç 

# å­˜å‚¨é…ç½®ï¼ˆæœ¬åœ°å­˜å‚¨ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ MinIO/S3ï¼‰
persistence:
  enabled: true
  size: 10Gi
  storageClass: ""  # ä½¿ç”¨é»˜è®¤ StorageClass

# æ•°æ®ä¿ç•™é…ç½®
config:
  ZO_DATA_DIR: "/data"
  ZO_HTTP_PORT: "5080"
  ZO_TELEMETRY: "false"  # ç¦ç”¨é¥æµ‹

# æ¢é’ˆé…ç½®
livenessProbe:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 10

readinessProbe:
  enabled: true
  initialDelaySeconds: 5
  periodSeconds: 5
```

**é…ç½®è¯´æ˜ï¼š**

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| `replicaCount` | Standalone æ¨¡å¼å›ºå®šä¸º 1 |
| `ZO_ROOT_USER_EMAIL` | ç®¡ç†å‘˜ç™»å½•é‚®ç®± |
| `ZO_ROOT_USER_PASSWORD` | ç®¡ç†å‘˜å¯†ç ï¼ˆè¯·ä½¿ç”¨å¼ºå¯†ç ï¼‰ |
| `persistence.size` | æ•°æ®å­˜å‚¨å¤§å° |
| `resources` | Pod èµ„æºé™åˆ¶ |

---

### æ­¥éª¤ 4ï¼šæ‰§è¡Œ Helm å®‰è£…

```bash
helm install openobserve openobserve/openobserve \
  --namespace openobserve \
  -f openobserve-values.yaml
```

**âœ… æ£€æŸ¥ç‚¹ï¼š** ç­‰å¾… Pod å°±ç»ªï¼š

```bash
kubectl get pods -n openobserve -w
```

é¢„æœŸè¾“å‡ºï¼š

```
NAME                           READY   STATUS    RESTARTS   AGE
openobserve-xxxxxxxxx-xxxxx    1/1     Running   0          2m
```

---

### æ­¥éª¤ 5ï¼šéªŒè¯éƒ¨ç½²çŠ¶æ€

```bash
# æŸ¥çœ‹ Pod çŠ¶æ€
kubectl get pods -n openobserve

# æŸ¥çœ‹ Service
kubectl get svc -n openobserve

# æŸ¥çœ‹ Pod æ—¥å¿—
kubectl logs -n openobserve -l app.kubernetes.io/name=openobserve --tail=50
```

**âœ… æ£€æŸ¥ç‚¹ï¼š** æ—¥å¿—ä¸­åº”åŒ…å« `Starting OpenObserve` æˆ–ç±»ä¼¼å¯åŠ¨æˆåŠŸä¿¡æ¯ã€‚

---

### æ­¥éª¤ 6ï¼šé…ç½®è®¿é—®

#### æ–¹å¼ 1ï¼šç«¯å£è½¬å‘ï¼ˆå¼€å‘æµ‹è¯•ï¼‰

```bash
kubectl port-forward svc/openobserve 5080:5080 -n openobserve
```

ç„¶åè®¿é—®ï¼š`http://localhost:5080`

#### æ–¹å¼ 2ï¼šIngressï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

åˆ›å»º Ingress èµ„æºï¼ˆå¯é€‰ï¼‰ï¼š

```yaml
# openobserve-ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: openobserve-ingress
  namespace: openobserve
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "100m"
spec:
  ingressClassName: nginx
  rules:
  - host: openobserve.your-domain.com  # è¯·æ›¿æ¢ä¸ºå®é™…åŸŸå
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: openobserve
            port:
              number: 5080
```

---

### éƒ¨ç½²æµç¨‹å›¾

```mermaid
flowchart TD
    A[åˆ›å»º Namespace] --> B[æ·»åŠ  Helm ä»“åº“]
    B --> C[åˆ›å»º values.yaml]
    C --> D[æ‰§è¡Œ Helm install]
    D --> E{Pod çŠ¶æ€æ£€æŸ¥}
    E -->|Running| F[é…ç½®è®¿é—®æ–¹å¼]
    E -->|Error| G[æŸ¥çœ‹æ—¥å¿—æ’é”™]
    G --> D
    F --> H[è®¿é—® Web UI]
    H --> I[éƒ¨ç½²å®Œæˆ âœ…]
```

---

## ğŸŒ è®¿é—® OpenObserve

### ç™»å½• Web UI

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5080`ï¼ˆæˆ– Ingress åŸŸåï¼‰
2. ä½¿ç”¨é…ç½®çš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ï¼š
   - **é‚®ç®±**ï¼š`admin@example.com`ï¼ˆvalues.yaml ä¸­é…ç½®ï¼‰
   - **å¯†ç **ï¼š`your-secure-password`ï¼ˆvalues.yaml ä¸­é…ç½®ï¼‰

### Web UI åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **Logs** | æ—¥å¿—æœç´¢ä¸åˆ†æ |
| **Streams** | æ•°æ®æµç®¡ç† |
| **Dashboards** | å¯è§†åŒ–ä»ªè¡¨æ¿ |
| **Alerts** | å‘Šè­¦è§„åˆ™é…ç½® |
| **Ingestion** | æ•°æ®æ¥å…¥é…ç½® |

---

## âš™ï¸ é…ç½®è¯¦è§£

### API ç«¯ç‚¹

| ç«¯ç‚¹ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `/api/{org}/{stream}/_json` | JSON æ—¥å¿—å†™å…¥ | `/api/default/logs/_json` |
| `/api/{org}/{stream}/_bulk` | Bulk æ‰¹é‡å†™å…¥ | `/api/default/logs/_bulk` |
| `/api/{org}/_search` | æ—¥å¿—æœç´¢ | POST æŸ¥è¯¢ |

### å­˜å‚¨é…ç½®ï¼ˆMinIOï¼‰

> ğŸ’¡ **æ³¨æ„**ï¼šMinIO çš„è¯¦ç»†é…ç½®å°†åœ¨åç»­åšå®¢ä¸­ä»‹ç»ã€‚

ç®€è¦é…ç½®ç¤ºä¾‹ï¼š

```yaml
config:
  ZO_S3_SERVER_URL: "http://minio.minio:9000"
  ZO_S3_ACCESS_KEY: "your-access-key"
  ZO_S3_SECRET_KEY: "your-secret-key"
  ZO_S3_BUCKET_NAME: "openobserve"
  ZO_S3_REGION_NAME: "us-east-1"
```

---

## æ€»ç»“

æœ¬ç« æˆ‘ä»¬å®Œæˆäº†ï¼š

1. âœ… äº†è§£äº† OpenObserve + Vector çš„æ•´ä½“æ¶æ„
2. âœ… ç†è§£äº†å„ç»„ä»¶çš„èŒè´£å’Œæ•°æ®æµå‘
3. âœ… é€šè¿‡ Helm éƒ¨ç½²äº† OpenObserve Standalone æ¨¡å¼
4. âœ… éªŒè¯äº†éƒ¨ç½²çŠ¶æ€å¹¶è®¿é—®äº† Web UI

ä¸‹ä¸€ç« æˆ‘ä»¬å°†éƒ¨ç½² Vector DaemonSetï¼Œé…ç½®æ—¥å¿—é‡‡é›†å¹¶å‘é€åˆ° OpenObserveã€‚

---

| â¬…ï¸ ä¸Šä¸€ç«  | ğŸ  ç›®å½• | ä¸‹ä¸€ç«  â¡ï¸ |
|:----------|:------:|----------:|
| - | [è¿”å›ç›®å½•](../../) | [Vector DaemonSet é…ç½®ä¸éƒ¨ç½²](../02-Vectoréƒ¨ç½²/01-DaemonSeté…ç½®ä¸éƒ¨ç½².md) |

